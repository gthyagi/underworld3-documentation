[
  {
    "objectID": "ConstitutiveModels_Introduction.html",
    "href": "ConstitutiveModels_Introduction.html",
    "title": "3  Underworld 3: Constitutive Models",
    "section": "",
    "text": "3.1 Constitutive tensors\nIn Underworld, the underlying implementation of any consitutive relationship is through the appropriate tensor representation, allowing for a very general formulation for most problems. The constitutive tensors are described symbolically using sympy expressions. For scalar equations, the rank 2 constitutive tensor (\\(k_{ij}\\)) can be expressed as a matrix without any loss of generality.\nFor vector equations, the constitutive tensor is of rank 4, but it is common in the engineering / finite element literature to transform the rank 4 tensor to a matrix representation. This has some benefits in terms of legibility and, perhaps, results in common code patterns across the formulation for scalar equations.\nWe can write the stress and strain rate tensors (\\(\\tau_{ij}\\) and \\(\\dot\\epsilon_{ij}\\) respectively) as\n\\[ \\tau_I = \\left( \\tau_{00}, \\tau_{11}, \\tau_{22}, \\tau_{12}, \\tau_{02}, \\tau_{01} \\right) \\]\n\\[ \\dot\\varepsilon_I = \\left( \\dot\\varepsilon_{00}, \\dot\\varepsilon_{11}, \\dot\\varepsilon_{22}, \\dot\\varepsilon_{12}, \\dot\\varepsilon_{02}, \\dot\\varepsilon_{01} \\right) \\]\nwhere \\(I\\) indexes \\(\\{i,j\\}\\) in a specified order and symmetry of the tensor implies only six (in 3D) unique entries in the nine entries of a general tensor. With these definitions, the constitutive tensor can be written as \\(C_{IJ}\\) where \\(I\\), and \\(J\\) range over the independent degrees of freedom in stress and strain (rate). This is a re-writing of the full tensor, with the necessary symmetry required to respect the symmetry of \\(\\tau\\) and \\(\\dot\\varepsilon\\)\nThe simplified notation comes at a cost. For example, \\(\\tau_I \\dot\\varepsilon_I\\) is not equivalent to the tensor inner produce \\(\\tau_{ij} \\dot\\varepsilon_{ij}\\), and \\(C_{IJ}\\) does not transform correctly for a rotation of coordinates.\nHowever, a modest transformation of the matrix equations is helpful:\n\\[ \\tau^*_{I} = C^*_{IJ} \\varepsilon^*_{J} \\]\nWhere\n\\[\\tau^*_{I} = P_{IJ} \\tau^*_J\\]\n\\[\\varepsilon^*_I = P_{IJ} \\varepsilon^*_J\\]\n\\[C^*_{IJ} = P_{IK} C_{KL} P_{LJ}\\]\n\\(\\mathbf{P}\\) is the scaling matrix\n\\[P = \\left[\\begin{matrix}1 & 0 & 0 & 0 & 0 & 0\\\\0 & 1 & 0 & 0 & 0 & 0\\\\0 & 0 & 1 & 0 & 0 & 0\\\\0 & 0 & 0 & \\sqrt{2} & 0 & 0\\\\0 & 0 & 0 & 0 & \\sqrt{2} & 0\\\\0 & 0 & 0 & 0 & 0 & \\sqrt{2}\\end{matrix}\\right]\\]\nIn this form, known as the Mandel notation, \\(\\tau^*_I\\varepsilon^*_I \\equiv \\tau_{ij} \\varepsilon_{ij}\\), and the fourth order identity matrix:\n\\[I_{ijkl} = \\frac{1}{2} \\left( \\delta_{ij}\\delta_{kj} + \\delta_{kl}\\delta_{il} \\right)\\]\ntransforms to\n\\[I_{IJ} = \\delta_{IJ}\\]",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Underworld 3: Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Introduction.html#constitutive-tensors",
    "href": "ConstitutiveModels_Introduction.html#constitutive-tensors",
    "title": "3  Underworld 3: Constitutive Models",
    "section": "",
    "text": "3.1.1 Voigt form\nComputation of the stress tensor using \\(\\tau^*_I = C^*_{IJ}\\varepsilon^*_J\\) is equivalent to the following\n\\[ \\mathbf{P} \\mathbf{\\tau} =  \\mathbf{P} \\mathbf{C} \\mathbf{P} \\cdot \\mathbf{P} \\mathbf{\\varepsilon} \\]\nmultiply by $^{-1} $ and collecting terms:\n\\[ \\mathbf{\\tau} = \\mathbf{C} \\mathbf{P}^2 \\mathbf{\\varepsilon} \\]\nThis is the Voigt form of the constitutive equations and is generally what you will find in a finite element textbook. The Voigt form of the constitutive matrix is the rearrangement of the rank 4 constitutive tensor (with no scaling), the strain rate vector is usually combined with \\(\\mathbf{P}^2\\), and the stress vector is raw. For example:\n\\[ \\left[\\begin{matrix}\\tau_{0 0}\\\\\\tau_{1 1}\\\\\\tau_{0 1}\\end{matrix}\\right] =\n   \\left[\\begin{matrix}\\eta & 0 & 0\\\\0 & \\eta & 0\\\\0 & 0 & \\frac{\\eta}{2}\\end{matrix}\\right]   \\left[\\begin{matrix}\\dot\\varepsilon_{0 0}\\\\\\dot\\varepsilon_{1 1}\\\\2 \\dot\\varepsilon_{0 1}\\end{matrix}\\right]\n\\]\nA full discussion of this can be found in Brannon (2018) and in helnweinRemarksCompressedMatrix2001",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Underworld 3: Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Introduction.html#sympy-tensorial-form-voigt-form",
    "href": "ConstitutiveModels_Introduction.html#sympy-tensorial-form-voigt-form",
    "title": "3  Underworld 3: Constitutive Models",
    "section": "3.2 Sympy tensorial form, Voigt form",
    "text": "3.2 Sympy tensorial form, Voigt form\nThe rank 4 tensor form of the constitutive equations, \\(c_{ijkl}\\), has the following (2D) representation in sympy:\n\\[\\left[\\begin{matrix}\\left[\\begin{matrix}c_{0 0 0 0} & c_{0 0 0 1}\\\\c_{0 0 1 0} & c_{0 0 1 1}\\end{matrix}\\right] & \\left[\\begin{matrix}c_{0 1 0 0} & c_{0 1 0 1}\\\\c_{0 1 1 0} & c_{0 1 1 1}\\end{matrix}\\right]\\\\\\left[\\begin{matrix}c_{1 0 0 0} & c_{1 0 0 1}\\\\c_{1 0 1 0} & c_{1 0 1 1}\\end{matrix}\\right] & \\left[\\begin{matrix}c_{1 1 0 0} & c_{1 1 0 1}\\\\c_{1 1 1 0} & c_{1 1 1 1}\\end{matrix}\\right]\\end{matrix}\\right]\\]\nand the inner product ${ij} = c{ijkl} _{kl} $ is written\ntau = sympy.tensorcontraction(\n            sympy.tensorcontraction(\n                   sympy.tensorproduct(c, epsilon),(3,5)),(2,3))\nHowever, the sympy.Matrix module allows a much simpler expression\ntau_star = C_star * epsilon_star\ntau = P.inv() * tau_star\nwhich we adopt in underworld for the display and manipulation of constitutive tensors in either the Mandel form or the (more common in Engineering texts) Voigt form.\n\n\n\n\nBrannon, Rm. 2018. Rotation Reflection and Frame Changes Orthogonal Tensors in Computational Engineering Mechanics. IOP Publishing. https://doi.org/10.1088/978-0-7503-1454-1.",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Underworld 3: Constitutive Models</span>"
    ]
  },
  {
    "objectID": "Introduction.html",
    "href": "Introduction.html",
    "title": "2  Underworld 3",
    "section": "",
    "text": "+++\nNot much content in the intro at this point\nUpdate the _toc.yml first, then fix the rest",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Underworld 3</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html",
    "href": "ConstitutiveModels_Anisotropy.html",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "",
    "text": "4.1 Canonical forms\nThe expressions for our anisotropic tensors are provided in a canonical reference frame which exploits the symmetry of the material to present the most compact form of the constitutive tensors.\nThis wikipedia article should also be helpful.\nIn a general orientation, a rotation tensor \\({\\cal R}\\) is required to transform to / from this canonical frame. For isotropic materials, \\({\\cal R}\\) is the identity matrix. For cubic materials, a single angle describes the offset of the two frames, and for transversely isotropic materials, we need to define a rotation matrix that aligns the normal to the symmetry plane with the vertical axis in the canonical frame. These examples have fewer degrees of freedom than a full rotation matrix and this fact can be used to simplify the general (rotated) form of the constitutive tensors.\nDefine \\({\\cal R}_{ij}\\) as the rotation matrix that maps the coordinates \\(x\\) onto the \\(x'\\) coordiate system, i.e.\n\\[a_i' = {\\cal R}_{ij} \\, a_j \\]\n\\({\\cal R}_{ij}\\) also has this property:\n\\[ {\\cal R}_{ki}\\,{\\cal R}_{kj} = \\delta_{ij} \\]\nSecond order tensors transform as follows:\n\\[a_{ij}' = {\\cal R}_{ik}\\,{\\cal R}_{jl}\\,a_{kl},\\]\nand for higher rank tensors, we just continue …\n\\[a_{ijk}' = {\\cal R}_{il}\\,{\\cal R}_{jm}\\,{\\cal R}_{kn}\\,a_{lmn}.\\]\nIn underworld tensor rotation is provided for rank 2 and rank 4 tensors by uw.maths.tensor.tensor_rotation(R, tensor_expression)",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#canonical-forms",
    "href": "ConstitutiveModels_Anisotropy.html#canonical-forms",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "",
    "text": "Figure 4.1: Symmetries in constitutive models (LINK) from Pamela Burnley, University of Nevada Las Vegas and based on Nye (1984).",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#muhlhaus-moresi-transversely-isotropic-tensor",
    "href": "ConstitutiveModels_Anisotropy.html#muhlhaus-moresi-transversely-isotropic-tensor",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "4.4 Muhlhaus / Moresi transversely isotropic tensor",
    "text": "4.4 Muhlhaus / Moresi transversely isotropic tensor\nThe Muhlhaus / Moresi transversely isotropic consitituve model is designed to model materials that have a single (usually) weak plane (e.g. an embedded fault).\nThe constitutive model is\n\\[\\left[\\begin{matrix}2 \\eta_{0} & 0 & 0 & 0 & 0 & 0\\\\0 & 2 \\eta_{0} & 0 & 0 & 0 & 0\\\\0 & 0 & 2 \\eta_{0} & 0 & 0 & 0\\\\0 & 0 & 0 & - 2 \\Delta\\eta + 2 \\eta_{0} & 0 & 0\\\\0 & 0 & 0 & 0 & - 2 \\Delta\\eta + 2 \\eta_{0} & 0\\\\0 & 0 & 0 & 0 & 0 & 2 \\eta_{0}\\end{matrix}\\right]\\]\nwhere \\(\\Delta\\eta\\) represents the change (usually reduction) in viscosity.\nRotation using \\(\\cal R\\) as defined from the normal to the weak plane (above) gives (Mandel form):\n\\[\\left[\\begin{matrix}- \\frac{4 \\Delta\\eta n_{0}^{2} \\left(n_{0}^{2} n_{2}^{2} + n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} + 2 \\eta_{0} & \\frac{4 \\Delta\\eta n_{0}^{2} n_{1}^{2} \\cdot \\left(1 - n_{2}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} & 4 \\Delta\\eta n_{0}^{2} n_{2}^{2} & \\frac{2 \\sqrt{2} \\Delta\\eta n_{0}^{2} n_{1} n_{2} \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2} + 1\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\sqrt{2} \\Delta\\eta n_{0} n_{2} \\left(n_{0}^{2} \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2}\\right) - n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\sqrt{2} \\Delta\\eta n_{0} n_{1} \\left(- 2 n_{0}^{2} n_{2}^{2} + n_{0}^{2} - n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}}\\\\\\frac{4 \\Delta\\eta n_{0}^{2} n_{1}^{2} \\cdot \\left(1 - n_{2}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} & - \\frac{4 \\Delta\\eta n_{1}^{2} \\left(n_{0}^{2} + n_{1}^{2} n_{2}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} + 2 \\eta_{0} & 4 \\Delta\\eta n_{1}^{2} n_{2}^{2} & - \\frac{2 \\sqrt{2} \\Delta\\eta n_{1} n_{2} \\left(n_{0}^{2} - n_{1}^{2} \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2}\\right)\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\sqrt{2} \\Delta\\eta n_{0} n_{1}^{2} n_{2} \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2} + 1\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\sqrt{2} \\Delta\\eta n_{0} n_{1} \\left(- n_{0}^{2} - 2 n_{1}^{2} n_{2}^{2} + n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}}\\\\4 \\Delta\\eta n_{0}^{2} n_{2}^{2} & 4 \\Delta\\eta n_{1}^{2} n_{2}^{2} & - 4 \\Delta\\eta n_{2}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right) + 2 \\eta_{0} & 2 \\sqrt{2} \\Delta\\eta n_{1} n_{2} \\left(- n_{0}^{2} - n_{1}^{2} + n_{2}^{2}\\right) & 2 \\sqrt{2} \\Delta\\eta n_{0} n_{2} \\left(- n_{0}^{2} - n_{1}^{2} + n_{2}^{2}\\right) & 4 \\sqrt{2} \\Delta\\eta n_{0} n_{1} n_{2}^{2}\\\\\\frac{2 \\sqrt{2} \\Delta\\eta n_{0}^{2} n_{1} n_{2} \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2} + 1\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\sqrt{2} \\Delta\\eta n_{1} n_{2} \\left(n_{0}^{2} n_{1}^{2} - n_{0}^{2} + n_{1}^{4} - n_{1}^{2} n_{2}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} & 2 \\sqrt{2} \\Delta\\eta n_{1} n_{2} \\left(- n_{0}^{2} - n_{1}^{2} + n_{2}^{2}\\right) & - \\frac{2 \\Delta\\eta \\left(n_{0}^{2} n_{2}^{2} - n_{1}^{2} n_{2}^{2} \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2}\\right) + n_{1}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right) \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2}\\right)\\right)}{n_{0}^{2} + n_{1}^{2}} + 2 \\eta_{0} & \\frac{2 \\Delta\\eta n_{0} n_{1} \\left(n_{2}^{2} \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2}\\right) + n_{2}^{2} - \\left(n_{0}^{2} + n_{1}^{2}\\right) \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2}\\right)\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\Delta\\eta n_{0} n_{2} \\cdot \\left(2 n_{0}^{2} n_{1}^{2} - n_{0}^{2} + 2 n_{1}^{4} - 2 n_{1}^{2} n_{2}^{2} + n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}}\\\\\\frac{2 \\sqrt{2} \\Delta\\eta n_{0} n_{2} \\left(n_{0}^{4} + n_{0}^{2} n_{1}^{2} - n_{0}^{2} n_{2}^{2} - n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\sqrt{2} \\Delta\\eta n_{0} n_{1}^{2} n_{2} \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2} + 1\\right)}{n_{0}^{2} + n_{1}^{2}} & 2 \\sqrt{2} \\Delta\\eta n_{0} n_{2} \\left(- n_{0}^{2} - n_{1}^{2} + n_{2}^{2}\\right) & \\frac{2 \\Delta\\eta n_{0} n_{1} \\left(n_{2}^{2} \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2}\\right) + n_{2}^{2} - \\left(n_{0}^{2} + n_{1}^{2}\\right) \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2}\\right)\\right)}{n_{0}^{2} + n_{1}^{2}} & - \\frac{2 \\Delta\\eta \\left(- n_{0}^{2} n_{2}^{2} \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2}\\right) + n_{0}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right) \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2}\\right) + n_{1}^{2} n_{2}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} + 2 \\eta_{0} & \\frac{2 \\Delta\\eta n_{1} n_{2} \\cdot \\left(2 n_{0}^{4} + 2 n_{0}^{2} n_{1}^{2} - 2 n_{0}^{2} n_{2}^{2} + n_{0}^{2} - n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}}\\\\\\frac{2 \\sqrt{2} \\Delta\\eta n_{0} n_{1} \\left(- 2 n_{0}^{2} n_{2}^{2} + n_{0}^{2} - n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\sqrt{2} \\Delta\\eta n_{0} n_{1} \\left(- n_{0}^{2} - 2 n_{1}^{2} n_{2}^{2} + n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} & 4 \\sqrt{2} \\Delta\\eta n_{0} n_{1} n_{2}^{2} & \\frac{2 \\Delta\\eta n_{0} n_{2} \\left(- n_{0}^{2} + 2 n_{1}^{2} \\left(n_{0}^{2} + n_{1}^{2} - n_{2}^{2}\\right) + n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\Delta\\eta n_{1} n_{2} \\cdot \\left(2 n_{0}^{4} + 2 n_{0}^{2} n_{1}^{2} - 2 n_{0}^{2} n_{2}^{2} + n_{0}^{2} - n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\Delta\\eta \\left(- n_{0}^{4} - 4 n_{0}^{2} n_{1}^{2} n_{2}^{2} + 2 n_{0}^{2} n_{1}^{2} - n_{1}^{4}\\right)}{n_{0}^{2} + n_{1}^{2}} + 2 \\eta_{0}\\end{matrix}\\right]\\]\nand we can easily demonstrate that this collapses back to the isotropic form if \\(\\Delta\\eta \\leftarrow 0\\). We can also show this is equivalent to the alternate expression for the tensor provided in the original papers (an exercise for the reader !!).\n\n\n\n\n\n\nUnderworld python script\n\n\n\n\n\n# Muhlhaus definition of C_IJ (mandel form)\n\neta1 = sympy.symbols(\"\\eta_1\")\ndelta_eta = sympy.symbols(\"\\Delta\\eta\")\n\nC_ijkl_MM = uw.maths.tensor.rank4_identity(3) * 0\nC_IJm_MM = uw.maths.tensor.rank4_to_mandel(C_ijkl_MM, 3)\nC_IJm_MM[0,0] = 2*eta0\nC_IJm_MM[1,1] = 2*eta0\nC_IJm_MM[2,2] = 2*eta0\nC_IJm_MM[3,3] = 2*(eta0-delta_eta)  # yz\nC_IJm_MM[4,4] = 2*(eta0-delta_eta)  # xz\nC_IJm_MM[5,5] = 2*eta0  # xy\n\ndisplay(C_IJm_MM)\n\n## We know that the isotropic part is invariant under rotation, so we only need to \n## examine the non-isotropic part.\n\nC_ijkl_MM = uw.maths.tensor.mandel_to_rank4(C_IJm_MM - C_IJm , 3)\nC_ijkl_MM_R = sympy.simplify(uw.maths.tensor.tensor_rotation(R, C_ijkl_MM))\n\nC_IJm_MM_R = sympy.simplify(uw.maths.tensor.rank4_to_mandel(C_ijkl_MM_R, 3)) + C_IJm\nC_IJv_MM_R = sympy.simplify(uw.maths.tensor.rank4_to_voigt(C_ijkl_MM_R, 3)) + C_IJv\n\ndisplay(C_IJm_MM_R)\n\n# Check what happens if we set delta eta to zero\nC_IJm_MM_iso = C_IJm_MM_R.subs(delta_eta,0).applyfunc(sympy.factor).subs(n[0]**2+n[1]**2, 1-n[2]**2).simplify()\ndisplay(C_IJm_MM_iso)",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#we-know-that-the-isotropic-part-is-invariant-under-rotation-so-we-only-need-to",
    "href": "ConstitutiveModels_Anisotropy.html#we-know-that-the-isotropic-part-is-invariant-under-rotation-so-we-only-need-to",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "4.9 We know that the isotropic part is invariant under rotation, so we only need to",
    "text": "4.9 We know that the isotropic part is invariant under rotation, so we only need to",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#examine-the-non-isotropic-part.",
    "href": "ConstitutiveModels_Anisotropy.html#examine-the-non-isotropic-part.",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "4.10 examine the non-isotropic part.",
    "text": "4.10 examine the non-isotropic part.\nC_ijkl_MM = uw.maths.tensor.mandel_to_rank4(C_IJm_MM - C_IJm , 3) C_ijkl_MM_R = sympy.simplify(uw.maths.tensor.tensor_rotation(R, C_ijkl_MM))\nC_IJm_MM_R = sympy.simplify(uw.maths.tensor.rank4_to_mandel(C_ijkl_MM_R, 3)) + C_IJm C_IJv_MM_R = sympy.simplify(uw.maths.tensor.rank4_to_voigt(C_ijkl_MM_R, 3)) + C_IJv\ndisplay(C_IJm_MM_R)",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#han-wahr-1997-full-transverse-isotropic-tensor",
    "href": "ConstitutiveModels_Anisotropy.html#han-wahr-1997-full-transverse-isotropic-tensor",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "4.5 Han & Wahr, 1997 (full transverse isotropic tensor)",
    "text": "4.5 Han & Wahr, 1997 (full transverse isotropic tensor)\nIn the {cite}hanAnalysisAnisotropicMantle1997 paper, the expression for incompressible transverse-isotropy is as follows\n\\[\\left[\\begin{matrix}2 \\eta_{0} + \\mu_{0} & \\mu_{0} & 0 & 0 & 0 & 0\\\\\\mu_{0} & 2 \\eta_{0} + \\mu_{0} & 0 & 0 & 0 & 0\\\\0 & 0 & - 2 \\Delta\\eta + 2 \\eta_{0} + \\mu_{1} & 0 & 0 & 0\\\\0 & 0 & 0 & - 2 \\Delta\\eta + 2 \\eta_{0} & 0 & 0\\\\0 & 0 & 0 & 0 & - 2 \\Delta\\eta + 2 \\eta_{0} & 0\\\\0 & 0 & 0 & 0 & 0 & 2 \\eta_{0}\\end{matrix}\\right]\\]\nNote that the notation differs from their paper. I have replaced their \\(\\nu1, \\nu2\\) with \\(\\eta0, \\eta1\\) to be consistent with the forms defined above. I have replaced their \\(\\eta\\) with \\(\\mu\\) to avoid the confusion that results from the first change.\nApplying the rotation, \\(\\cal R\\) and attempting to coerce sympy to simplify the constitutive matrix:\n\\[\\left[\\begin{matrix}\\frac{2 \\Delta\\eta n_{0}^{4} n_{2}^{4} - 2 \\Delta\\eta n_{0}^{4} + 4 \\Delta\\eta n_{0}^{2} n_{1}^{2} n_{2}^{2} - 4 \\Delta\\eta n_{0}^{2} n_{1}^{2} + 2 \\eta_{0} n_{2}^{4} - 4 \\eta_{0} n_{2}^{2} + 2 \\eta_{0} + \\mu_{0} n_{0}^{4} n_{2}^{4} + 2 \\mu_{0} n_{0}^{2} n_{1}^{2} n_{2}^{2} + \\mu_{0} n_{1}^{4} + \\mu_{1} n_{0}^{4} n_{2}^{4} - 2 \\mu_{1} n_{0}^{4} n_{2}^{2} + \\mu_{1} n_{0}^{4}}{\\left(n_{2} - 1\\right)^{2} \\left(n_{2} + 1\\right)^{2}} & \\frac{2 \\Delta\\eta n_{0}^{2} n_{1}^{2} n_{2}^{4} - 4 \\Delta\\eta n_{0}^{2} n_{1}^{2} n_{2}^{2} + 2 \\Delta\\eta n_{0}^{2} n_{1}^{2} + \\mu_{0} n_{0}^{4} n_{2}^{2} + \\mu_{0} n_{0}^{2} n_{1}^{2} n_{2}^{4} + \\mu_{0} n_{0}^{2} n_{1}^{2} + \\mu_{0} n_{1}^{4} n_{2}^{2} + \\mu_{1} n_{0}^{2} n_{1}^{2} n_{2}^{4} - 2 \\mu_{1} n_{0}^{2} n_{1}^{2} n_{2}^{2} + \\mu_{1} n_{0}^{2} n_{1}^{2}}{\\left(n_{2} - 1\\right)^{2} \\left(n_{2} + 1\\right)^{2}} & 2 \\Delta\\eta n_{0}^{2} n_{2}^{2} + \\mu_{0} n_{0}^{2} n_{2}^{2} + \\mu_{0} n_{1}^{2} + \\mu_{1} n_{0}^{2} n_{2}^{2} & \\frac{\\sqrt{2} n_{1} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} n_{2}^{2} - 2 \\Delta\\eta n_{0}^{2} + \\mu_{0} n_{0}^{2} n_{2}^{2} + \\mu_{0} n_{1}^{2} - \\mu_{1} n_{0}^{4} - \\mu_{1} n_{0}^{2} n_{1}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & \\frac{\\sqrt{2} n_{0} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} n_{2}^{2} + 2 \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} n_{2}^{2} + \\mu_{0} n_{1}^{2} - \\mu_{1} n_{0}^{4} - \\mu_{1} n_{0}^{2} n_{1}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & \\frac{\\sqrt{2} n_{0} n_{1} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} n_{2}^{2} + 2 \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} n_{2}^{2} + \\mu_{0} n_{1}^{2} + \\mu_{1} n_{0}^{2} n_{2}^{2} - \\mu_{1} n_{0}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)}\\\\\\frac{2 \\Delta\\eta n_{0}^{2} n_{1}^{2} n_{2}^{4} - 4 \\Delta\\eta n_{0}^{2} n_{1}^{2} n_{2}^{2} + 2 \\Delta\\eta n_{0}^{2} n_{1}^{2} + \\mu_{0} n_{0}^{4} n_{2}^{2} + \\mu_{0} n_{0}^{2} n_{1}^{2} n_{2}^{4} + \\mu_{0} n_{0}^{2} n_{1}^{2} + \\mu_{0} n_{1}^{4} n_{2}^{2} + \\mu_{1} n_{0}^{2} n_{1}^{2} n_{2}^{4} - 2 \\mu_{1} n_{0}^{2} n_{1}^{2} n_{2}^{2} + \\mu_{1} n_{0}^{2} n_{1}^{2}}{\\left(n_{2} - 1\\right)^{2} \\left(n_{2} + 1\\right)^{2}} & \\frac{4 \\Delta\\eta n_{0}^{2} n_{1}^{2} n_{2}^{2} - 4 \\Delta\\eta n_{0}^{2} n_{1}^{2} + 2 \\Delta\\eta n_{1}^{4} n_{2}^{4} - 2 \\Delta\\eta n_{1}^{4} + 2 \\eta_{0} n_{2}^{4} - 4 \\eta_{0} n_{2}^{2} + 2 \\eta_{0} + \\mu_{0} n_{0}^{4} + 2 \\mu_{0} n_{0}^{2} n_{1}^{2} n_{2}^{2} + \\mu_{0} n_{1}^{4} n_{2}^{4} + \\mu_{1} n_{1}^{4} n_{2}^{4} - 2 \\mu_{1} n_{1}^{4} n_{2}^{2} + \\mu_{1} n_{1}^{4}}{\\left(n_{2} - 1\\right)^{2} \\left(n_{2} + 1\\right)^{2}} & 2 \\Delta\\eta n_{1}^{2} n_{2}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} n_{2}^{2} + \\mu_{1} n_{1}^{2} n_{2}^{2} & \\frac{\\sqrt{2} n_{1} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} + 2 \\Delta\\eta n_{1}^{2} n_{2}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} n_{2}^{2} - \\mu_{1} n_{0}^{2} n_{1}^{2} - \\mu_{1} n_{1}^{4}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & \\frac{\\sqrt{2} n_{0} n_{2} \\cdot \\left(2 \\Delta\\eta n_{1}^{2} n_{2}^{2} - 2 \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} n_{2}^{2} - \\mu_{1} n_{0}^{2} n_{1}^{2} - \\mu_{1} n_{1}^{4}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & \\frac{\\sqrt{2} n_{0} n_{1} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} + 2 \\Delta\\eta n_{1}^{2} n_{2}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} n_{2}^{2} + \\mu_{1} n_{1}^{2} n_{2}^{2} - \\mu_{1} n_{1}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)}\\\\2 \\Delta\\eta n_{0}^{2} n_{2}^{2} + \\mu_{0} n_{0}^{2} n_{2}^{2} + \\mu_{0} n_{1}^{2} + \\mu_{1} n_{0}^{2} n_{2}^{2} & 2 \\Delta\\eta n_{1}^{2} n_{2}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} n_{2}^{2} + \\mu_{1} n_{1}^{2} n_{2}^{2} & 2 \\Delta\\eta n_{2}^{4} - 4 \\Delta\\eta n_{2}^{2} + 2 \\eta_{0} + \\mu_{0} n_{2}^{4} - 2 \\mu_{0} n_{2}^{2} + \\mu_{0} + \\mu_{1} n_{2}^{4} & - \\sqrt{2} n_{1} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} + 2 \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} - \\mu_{1} n_{2}^{2}\\right) & - \\sqrt{2} n_{0} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} + 2 \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} - \\mu_{1} n_{2}^{2}\\right) & \\sqrt{2} n_{0} n_{1} \\cdot \\left(2 \\Delta\\eta n_{2}^{2} + \\mu_{0} n_{2}^{2} - \\mu_{0} + \\mu_{1} n_{2}^{2}\\right)\\\\\\frac{\\sqrt{2} n_{1} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} n_{2}^{2} - 2 \\Delta\\eta n_{0}^{2} + \\mu_{0} n_{0}^{2} n_{2}^{2} + \\mu_{0} n_{1}^{2} + \\mu_{1} n_{0}^{2} n_{2}^{2} - \\mu_{1} n_{0}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & \\frac{\\sqrt{2} n_{1} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} + 2 \\Delta\\eta n_{1}^{2} n_{2}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} n_{2}^{2} + \\mu_{1} n_{1}^{2} n_{2}^{2} - \\mu_{1} n_{1}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & - \\sqrt{2} n_{1} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} + 2 \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} - \\mu_{1} n_{2}^{2}\\right) & \\frac{2 \\left(\\Delta\\eta n_{0}^{2} n_{2}^{2} + 2 \\Delta\\eta n_{1}^{2} n_{2}^{4} - 2 \\Delta\\eta n_{1}^{2} n_{2}^{2} + \\Delta\\eta n_{1}^{2} + \\eta_{0} n_{2}^{2} - \\eta_{0} + \\mu_{0} n_{1}^{2} n_{2}^{4} - \\mu_{0} n_{1}^{2} n_{2}^{2} + \\mu_{1} n_{1}^{2} n_{2}^{4} - \\mu_{1} n_{1}^{2} n_{2}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & 2 n_{0} n_{1} \\cdot \\left(2 \\Delta\\eta n_{2}^{2} - \\Delta\\eta + \\mu_{0} n_{2}^{2} + \\mu_{1} n_{2}^{2}\\right) & \\frac{2 n_{0} n_{2} \\left(\\Delta\\eta n_{0}^{2} + 2 \\Delta\\eta n_{1}^{2} n_{2}^{2} - \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{1}^{2} n_{2}^{2} - \\mu_{0} n_{1}^{2} + \\mu_{1} n_{1}^{2} n_{2}^{2} - \\mu_{1} n_{1}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)}\\\\\\frac{\\sqrt{2} n_{0} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} n_{2}^{2} + 2 \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} n_{2}^{2} + \\mu_{0} n_{1}^{2} + \\mu_{1} n_{0}^{2} n_{2}^{2} - \\mu_{1} n_{0}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & \\frac{\\sqrt{2} n_{0} n_{2} \\cdot \\left(2 \\Delta\\eta n_{1}^{2} n_{2}^{2} - 2 \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} n_{2}^{2} + \\mu_{1} n_{1}^{2} n_{2}^{2} - \\mu_{1} n_{1}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & - \\sqrt{2} n_{0} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} + 2 \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} - \\mu_{1} n_{2}^{2}\\right) & 2 n_{0} n_{1} \\cdot \\left(2 \\Delta\\eta n_{2}^{2} - \\Delta\\eta + \\mu_{0} n_{2}^{2} + \\mu_{1} n_{2}^{2}\\right) & \\frac{2 \\cdot \\left(2 \\Delta\\eta n_{0}^{2} n_{2}^{4} - 2 \\Delta\\eta n_{0}^{2} n_{2}^{2} + \\Delta\\eta n_{0}^{2} + \\Delta\\eta n_{1}^{2} n_{2}^{2} + \\eta_{0} n_{2}^{2} - \\eta_{0} + \\mu_{0} n_{0}^{2} n_{2}^{4} - \\mu_{0} n_{0}^{2} n_{2}^{2} + \\mu_{1} n_{0}^{2} n_{2}^{4} - \\mu_{1} n_{0}^{2} n_{2}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & \\frac{2 n_{1} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} n_{2}^{2} - \\Delta\\eta n_{0}^{2} + \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} n_{2}^{2} - \\mu_{0} n_{0}^{2} + \\mu_{1} n_{0}^{2} n_{2}^{2} - \\mu_{1} n_{0}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)}\\\\\\frac{\\sqrt{2} n_{0} n_{1} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} n_{2}^{2} + 2 \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} n_{2}^{2} + \\mu_{0} n_{1}^{2} + \\mu_{1} n_{0}^{2} n_{2}^{2} - \\mu_{1} n_{0}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & \\frac{\\sqrt{2} n_{0} n_{1} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} + 2 \\Delta\\eta n_{1}^{2} n_{2}^{2} + \\mu_{0} n_{0}^{2} + \\mu_{0} n_{1}^{2} n_{2}^{2} + \\mu_{1} n_{1}^{2} n_{2}^{2} - \\mu_{1} n_{1}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & \\sqrt{2} n_{0} n_{1} \\cdot \\left(2 \\Delta\\eta n_{2}^{2} + \\mu_{0} n_{2}^{2} - \\mu_{0} + \\mu_{1} n_{2}^{2}\\right) & \\frac{2 n_{0} n_{2} \\left(\\Delta\\eta n_{0}^{2} + 2 \\Delta\\eta n_{1}^{2} n_{2}^{2} - \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{1}^{2} n_{2}^{2} - \\mu_{0} n_{1}^{2} - \\mu_{1} n_{0}^{2} n_{1}^{2} - \\mu_{1} n_{1}^{4}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & \\frac{2 n_{1} n_{2} \\cdot \\left(2 \\Delta\\eta n_{0}^{2} n_{2}^{2} - \\Delta\\eta n_{0}^{2} + \\Delta\\eta n_{1}^{2} + \\mu_{0} n_{0}^{2} n_{2}^{2} - \\mu_{0} n_{0}^{2} - \\mu_{1} n_{0}^{4} - \\mu_{1} n_{0}^{2} n_{1}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)} & \\frac{2 \\left(\\Delta\\eta n_{0}^{4} + 2 \\Delta\\eta n_{0}^{2} n_{1}^{2} n_{2}^{2} + \\Delta\\eta n_{1}^{4} + \\eta_{0} n_{2}^{2} - \\eta_{0} + \\mu_{0} n_{0}^{2} n_{1}^{2} n_{2}^{2} - \\mu_{0} n_{0}^{2} n_{1}^{2} + \\mu_{1} n_{0}^{2} n_{1}^{2} n_{2}^{2} - \\mu_{1} n_{0}^{2} n_{1}^{2}\\right)}{\\left(n_{2} - 1\\right) \\left(n_{2} + 1\\right)}\\end{matrix}\\right]\\]\nThe underworld / sympy implementation follows:\n\n\n\n\n\n\nUnderworld python script\n\n\n\n\n\n## The full incompressible, trans-iso model (4 independent unknowns) \n## from Han and Wahr (1997)\n\n# Extra viscosity terms\nmu0 = sympy.symbols(r\"\\mu_0\")\nmu1 = sympy.symbols(r\"\\mu_1\")\n\nI = uw.maths.tensor.rank4_identity(3) * 0\nC_IJm_HW = uw.maths.tensor.rank4_to_mandel(I, 3)\nC_IJm_HW[0,0] = mu0 + 2 * eta0 \nC_IJm_HW[0,1] = mu0  \nC_IJm_HW[1,0] = mu0  \nC_IJm_HW[1,1] = mu0 + 2 * eta0\nC_IJm_HW[2,2] = mu1 + 2 * (eta0 - delta_eta)\nC_IJm_HW[3,3] = 2 * (eta0 - delta_eta) # yz\nC_IJm_HW[4,4] = 2 * (eta0 - delta_eta)  # xz\nC_IJm_HW[5,5] = 2 * eta0  # xy\n\ndisplay(C_IJm_HW)\n\nC_ijkl_HW = uw.maths.tensor.mandel_to_rank4(C_IJm_HW - C_IJm, 3)\ndisplay(uw.maths.tensor.rank4_to_mandel(C_ijkl_HW, 3)) \n\nC_ijkl_HW_R = sympy.simplify(uw.maths.tensor.tensor_rotation(R, C_ijkl_HW))\nsympy.simplify(uw.maths.tensor.rank4_to_mandel(C_ijkl_HW_R, 3)) + C_IJm\n\ndisplay(C_IJm_HW_R)\n\n## Maybe this can be simplified if we use the unit vector relationships among n0,n1,n2\n\nC_IJm_HW_R_s1 = C_IJm_HW_R.subs(n[0]**2+n[1]**2+n[2]**2,1)\nC_IJm_HW_R_s2 = C_IJm_HW_R_s1.subs(n[0]**2+n[1]**2, 1-n[2]**2).applyfunc(sympy.factor)\ndisplay(C_IJm_HW_R_s2)\n\n## Perhaps that's not so helpful",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#maybe-this-can-be-simplified-if-we-use-the-unit-vector-relationships-among-n0n1n2",
    "href": "ConstitutiveModels_Anisotropy.html#maybe-this-can-be-simplified-if-we-use-the-unit-vector-relationships-among-n0n1n2",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "6.1 Maybe this can be simplified if we use the unit vector relationships among n0,n1,n2",
    "text": "6.1 Maybe this can be simplified if we use the unit vector relationships among n0,n1,n2\nC_IJm_HW_R_s1 = C_IJm_HW_R.subs(n[0]2+n[1]2+n[2]2,1) C_IJm_HW_R_s2 = C_IJm_HW_R_s1.subs(n[0]2+n[1]2, 1-n[2]2).applyfunc(sympy.factor) display(C_IJm_HW_R_s2)",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#perhaps-thats-not-so-helpful",
    "href": "ConstitutiveModels_Anisotropy.html#perhaps-thats-not-so-helpful",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "6.2 Perhaps that’s not so helpful",
    "text": "6.2 Perhaps that’s not so helpful",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#orthotropic-medium",
    "href": "ConstitutiveModels_Anisotropy.html#orthotropic-medium",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "4.6 Orthotropic medium",
    "text": "4.6 Orthotropic medium\nNote all the caveats above regarding incompressibility. The {cite}browaeysDecompositionElasticTensor2004 elastic tensors have a bulk modulus term, so it is not completely obvious how to square the assumptions in the first two implementations with this set.\nThe full formulation should look like this:\n\\[\\left[\\begin{matrix}2 \\eta_{00} & 2 \\eta_{01} & 2 \\eta_{02} & 0 & 0 & 0\\\\2 \\eta_{01} & 2 \\eta_{11} & 2 \\eta_{12} & 0 & 0 & 0\\\\2 \\eta_{02} & 2 \\eta_{12} & 2 \\eta_{22} & 0 & 0 & 0\\\\0 & 0 & 0 & 2 \\eta_{33} & 0 & 0\\\\0 & 0 & 0 & 0 & 2 \\eta_{44} & 0\\\\0 & 0 & 0 & 0 & 0 & 2 \\eta_{55}\\end{matrix}\\right]\\]\nRotation in this case should be general as it is no longer enough to specify the symmetry plane.\n\\[\\left[\\begin{matrix}s_{0} & t_{0} & n_{0}\\\\s_{1} & t_{1} & n_{1}\\\\s_{2} & t_{2} & n_{2}\\end{matrix}\\right]\\]\n\\(\\hat{\\mathbf{n}}\\), \\(\\hat{\\mathbf{s}}\\) and \\(\\hat{\\mathbf{t}}\\) are an arbitrary orthogonal triad of unit vectors (we keep the notation from the Mühlhaus formulation). It is probably not useful to code up this form.\n\\[\\left[\\begin{matrix}2 \\eta_{00} s_{0}^{4} + 4 \\eta_{01} s_{0}^{2} t_{0}^{2} + 4 \\eta_{02} n_{0}^{2} s_{0}^{2} + 2 \\eta_{11} t_{0}^{4} + 4 \\eta_{12} n_{0}^{2} t_{0}^{2} + 2 \\eta_{22} n_{0}^{4} + 4 \\eta_{33} n_{0}^{2} t_{0}^{2} + 4 \\eta_{44} n_{0}^{2} s_{0}^{2} + 4 \\eta_{55} s_{0}^{2} t_{0}^{2} & 2 n_{0} \\left(\\eta_{33} n_{1} t_{0} t_{1} + \\eta_{44} n_{1} s_{0} s_{1} + n_{0} \\left(\\eta_{02} s_{1}^{2} + \\eta_{12} t_{1}^{2} + \\eta_{22} n_{1}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{0} n_{1} s_{1} + \\eta_{55} s_{1} t_{0} t_{1} + s_{0} \\left(\\eta_{00} s_{1}^{2} + \\eta_{01} t_{1}^{2} + \\eta_{02} n_{1}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{0} n_{1} t_{1} + \\eta_{55} s_{0} s_{1} t_{1} + t_{0} \\left(\\eta_{01} s_{1}^{2} + \\eta_{11} t_{1}^{2} + \\eta_{12} n_{1}^{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} n_{2} t_{0} t_{2} + \\eta_{44} n_{2} s_{0} s_{2} + n_{0} \\left(\\eta_{02} s_{2}^{2} + \\eta_{12} t_{2}^{2} + \\eta_{22} n_{2}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{0} n_{2} s_{2} + \\eta_{55} s_{2} t_{0} t_{2} + s_{0} \\left(\\eta_{00} s_{2}^{2} + \\eta_{01} t_{2}^{2} + \\eta_{02} n_{2}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{0} n_{2} t_{2} + \\eta_{55} s_{0} s_{2} t_{2} + t_{0} \\left(\\eta_{01} s_{2}^{2} + \\eta_{11} t_{2}^{2} + \\eta_{12} n_{2}^{2}\\right)\\right) & \\sqrt{2} \\left(n_{0} \\left(\\eta_{33} t_{0} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{0} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{0} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + s_{0} \\left(\\eta_{44} n_{0} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{0} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{0} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + t_{0} \\left(\\eta_{33} n_{0} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{0} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{0} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{0} \\left(\\eta_{33} t_{0} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{0} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{0} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + s_{0} \\left(\\eta_{44} n_{0} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{0} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{0} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + t_{0} \\left(\\eta_{33} n_{0} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{0} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{0} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{0} \\left(\\eta_{33} t_{0} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{0} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{0} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + s_{0} \\left(\\eta_{44} n_{0} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{0} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{0} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + t_{0} \\left(\\eta_{33} n_{0} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{0} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{0} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\right)\\\\2 n_{1} \\left(\\eta_{33} n_{0} t_{0} t_{1} + \\eta_{44} n_{0} s_{0} s_{1} + n_{1} \\left(\\eta_{02} s_{0}^{2} + \\eta_{12} t_{0}^{2} + \\eta_{22} n_{0}^{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{0} n_{1} s_{0} + \\eta_{55} s_{0} t_{0} t_{1} + s_{1} \\left(\\eta_{00} s_{0}^{2} + \\eta_{01} t_{0}^{2} + \\eta_{02} n_{0}^{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{0} n_{1} t_{0} + \\eta_{55} s_{0} s_{1} t_{0} + t_{1} \\left(\\eta_{01} s_{0}^{2} + \\eta_{11} t_{0}^{2} + \\eta_{12} n_{0}^{2}\\right)\\right) & 2 \\eta_{00} s_{1}^{4} + 4 \\eta_{01} s_{1}^{2} t_{1}^{2} + 4 \\eta_{02} n_{1}^{2} s_{1}^{2} + 2 \\eta_{11} t_{1}^{4} + 4 \\eta_{12} n_{1}^{2} t_{1}^{2} + 2 \\eta_{22} n_{1}^{4} + 4 \\eta_{33} n_{1}^{2} t_{1}^{2} + 4 \\eta_{44} n_{1}^{2} s_{1}^{2} + 4 \\eta_{55} s_{1}^{2} t_{1}^{2} & 2 n_{1} \\left(\\eta_{33} n_{2} t_{1} t_{2} + \\eta_{44} n_{2} s_{1} s_{2} + n_{1} \\left(\\eta_{02} s_{2}^{2} + \\eta_{12} t_{2}^{2} + \\eta_{22} n_{2}^{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{1} n_{2} s_{2} + \\eta_{55} s_{2} t_{1} t_{2} + s_{1} \\left(\\eta_{00} s_{2}^{2} + \\eta_{01} t_{2}^{2} + \\eta_{02} n_{2}^{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{1} n_{2} t_{2} + \\eta_{55} s_{1} s_{2} t_{2} + t_{1} \\left(\\eta_{01} s_{2}^{2} + \\eta_{11} t_{2}^{2} + \\eta_{12} n_{2}^{2}\\right)\\right) & \\sqrt{2} \\left(n_{1} \\left(\\eta_{33} t_{1} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{1} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{1} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + s_{1} \\left(\\eta_{44} n_{1} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{1} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{1} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + t_{1} \\left(\\eta_{33} n_{1} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{1} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{1} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{1} \\left(\\eta_{33} t_{1} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{1} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{1} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + s_{1} \\left(\\eta_{44} n_{1} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{1} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{1} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + t_{1} \\left(\\eta_{33} n_{1} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{1} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{1} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{1} \\left(\\eta_{33} t_{1} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{1} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{1} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + s_{1} \\left(\\eta_{44} n_{1} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{1} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{1} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + t_{1} \\left(\\eta_{33} n_{1} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{1} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{1} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\right)\\\\2 n_{2} \\left(\\eta_{33} n_{0} t_{0} t_{2} + \\eta_{44} n_{0} s_{0} s_{2} + n_{2} \\left(\\eta_{02} s_{0}^{2} + \\eta_{12} t_{0}^{2} + \\eta_{22} n_{0}^{2}\\right)\\right) + 2 s_{2} \\left(\\eta_{44} n_{0} n_{2} s_{0} + \\eta_{55} s_{0} t_{0} t_{2} + s_{2} \\left(\\eta_{00} s_{0}^{2} + \\eta_{01} t_{0}^{2} + \\eta_{02} n_{0}^{2}\\right)\\right) + 2 t_{2} \\left(\\eta_{33} n_{0} n_{2} t_{0} + \\eta_{55} s_{0} s_{2} t_{0} + t_{2} \\left(\\eta_{01} s_{0}^{2} + \\eta_{11} t_{0}^{2} + \\eta_{12} n_{0}^{2}\\right)\\right) & 2 n_{2} \\left(\\eta_{33} n_{1} t_{1} t_{2} + \\eta_{44} n_{1} s_{1} s_{2} + n_{2} \\left(\\eta_{02} s_{1}^{2} + \\eta_{12} t_{1}^{2} + \\eta_{22} n_{1}^{2}\\right)\\right) + 2 s_{2} \\left(\\eta_{44} n_{1} n_{2} s_{1} + \\eta_{55} s_{1} t_{1} t_{2} + s_{2} \\left(\\eta_{00} s_{1}^{2} + \\eta_{01} t_{1}^{2} + \\eta_{02} n_{1}^{2}\\right)\\right) + 2 t_{2} \\left(\\eta_{33} n_{1} n_{2} t_{1} + \\eta_{55} s_{1} s_{2} t_{1} + t_{2} \\left(\\eta_{01} s_{1}^{2} + \\eta_{11} t_{1}^{2} + \\eta_{12} n_{1}^{2}\\right)\\right) & 2 \\eta_{00} s_{2}^{4} + 4 \\eta_{01} s_{2}^{2} t_{2}^{2} + 4 \\eta_{02} n_{2}^{2} s_{2}^{2} + 2 \\eta_{11} t_{2}^{4} + 4 \\eta_{12} n_{2}^{2} t_{2}^{2} + 2 \\eta_{22} n_{2}^{4} + 4 \\eta_{33} n_{2}^{2} t_{2}^{2} + 4 \\eta_{44} n_{2}^{2} s_{2}^{2} + 4 \\eta_{55} s_{2}^{2} t_{2}^{2} & \\sqrt{2} \\left(n_{2} \\left(\\eta_{33} t_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{2} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + s_{2} \\left(\\eta_{44} n_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{2} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + t_{2} \\left(\\eta_{33} n_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{2} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{2} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + s_{2} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + t_{2} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{2} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + s_{2} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + t_{2} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\right)\\\\\\sqrt{2} \\cdot \\left(2 n_{1} \\left(\\eta_{33} n_{0} t_{0} t_{2} + \\eta_{44} n_{0} s_{0} s_{2} + n_{2} \\left(\\eta_{02} s_{0}^{2} + \\eta_{12} t_{0}^{2} + \\eta_{22} n_{0}^{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{0} n_{2} s_{0} + \\eta_{55} s_{0} t_{0} t_{2} + s_{2} \\left(\\eta_{00} s_{0}^{2} + \\eta_{01} t_{0}^{2} + \\eta_{02} n_{0}^{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{0} n_{2} t_{0} + \\eta_{55} s_{0} s_{2} t_{0} + t_{2} \\left(\\eta_{01} s_{0}^{2} + \\eta_{11} t_{0}^{2} + \\eta_{12} n_{0}^{2}\\right)\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{1} \\left(\\eta_{33} n_{1} t_{1} t_{2} + \\eta_{44} n_{1} s_{1} s_{2} + n_{2} \\left(\\eta_{02} s_{1}^{2} + \\eta_{12} t_{1}^{2} + \\eta_{22} n_{1}^{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{1} n_{2} s_{1} + \\eta_{55} s_{1} t_{1} t_{2} + s_{2} \\left(\\eta_{00} s_{1}^{2} + \\eta_{01} t_{1}^{2} + \\eta_{02} n_{1}^{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{1} n_{2} t_{1} + \\eta_{55} s_{1} s_{2} t_{1} + t_{2} \\left(\\eta_{01} s_{1}^{2} + \\eta_{11} t_{1}^{2} + \\eta_{12} n_{1}^{2}\\right)\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{1} n_{2} \\left(\\eta_{02} s_{2}^{2} + \\eta_{12} t_{2}^{2} + \\eta_{22} n_{2}^{2} + \\eta_{33} t_{2}^{2} + \\eta_{44} s_{2}^{2}\\right) + 2 s_{1} s_{2} \\left(\\eta_{00} s_{2}^{2} + \\eta_{01} t_{2}^{2} + \\eta_{02} n_{2}^{2} + \\eta_{44} n_{2}^{2} + \\eta_{55} t_{2}^{2}\\right) + 2 t_{1} t_{2} \\left(\\eta_{01} s_{2}^{2} + \\eta_{11} t_{2}^{2} + \\eta_{12} n_{2}^{2} + \\eta_{33} n_{2}^{2} + \\eta_{55} s_{2}^{2}\\right)\\right) & 2 n_{1} \\left(\\eta_{33} t_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{2} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{2} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{2} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right) & 2 n_{1} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right) & 2 n_{1} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\\\\\sqrt{2} \\cdot \\left(2 n_{0} \\left(\\eta_{33} n_{0} t_{0} t_{2} + \\eta_{44} n_{0} s_{0} s_{2} + n_{2} \\left(\\eta_{02} s_{0}^{2} + \\eta_{12} t_{0}^{2} + \\eta_{22} n_{0}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{0} n_{2} s_{0} + \\eta_{55} s_{0} t_{0} t_{2} + s_{2} \\left(\\eta_{00} s_{0}^{2} + \\eta_{01} t_{0}^{2} + \\eta_{02} n_{0}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{0} n_{2} t_{0} + \\eta_{55} s_{0} s_{2} t_{0} + t_{2} \\left(\\eta_{01} s_{0}^{2} + \\eta_{11} t_{0}^{2} + \\eta_{12} n_{0}^{2}\\right)\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{0} \\left(\\eta_{33} n_{1} t_{1} t_{2} + \\eta_{44} n_{1} s_{1} s_{2} + n_{2} \\left(\\eta_{02} s_{1}^{2} + \\eta_{12} t_{1}^{2} + \\eta_{22} n_{1}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{1} n_{2} s_{1} + \\eta_{55} s_{1} t_{1} t_{2} + s_{2} \\left(\\eta_{00} s_{1}^{2} + \\eta_{01} t_{1}^{2} + \\eta_{02} n_{1}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{1} n_{2} t_{1} + \\eta_{55} s_{1} s_{2} t_{1} + t_{2} \\left(\\eta_{01} s_{1}^{2} + \\eta_{11} t_{1}^{2} + \\eta_{12} n_{1}^{2}\\right)\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{0} n_{2} \\left(\\eta_{02} s_{2}^{2} + \\eta_{12} t_{2}^{2} + \\eta_{22} n_{2}^{2} + \\eta_{33} t_{2}^{2} + \\eta_{44} s_{2}^{2}\\right) + 2 s_{0} s_{2} \\left(\\eta_{00} s_{2}^{2} + \\eta_{01} t_{2}^{2} + \\eta_{02} n_{2}^{2} + \\eta_{44} n_{2}^{2} + \\eta_{55} t_{2}^{2}\\right) + 2 t_{0} t_{2} \\left(\\eta_{01} s_{2}^{2} + \\eta_{11} t_{2}^{2} + \\eta_{12} n_{2}^{2} + \\eta_{33} n_{2}^{2} + \\eta_{55} s_{2}^{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{2} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{2} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{2} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\\\\\sqrt{2} \\cdot \\left(2 n_{0} \\left(\\eta_{33} n_{0} t_{0} t_{1} + \\eta_{44} n_{0} s_{0} s_{1} + n_{1} \\left(\\eta_{02} s_{0}^{2} + \\eta_{12} t_{0}^{2} + \\eta_{22} n_{0}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{0} n_{1} s_{0} + \\eta_{55} s_{0} t_{0} t_{1} + s_{1} \\left(\\eta_{00} s_{0}^{2} + \\eta_{01} t_{0}^{2} + \\eta_{02} n_{0}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{0} n_{1} t_{0} + \\eta_{55} s_{0} s_{1} t_{0} + t_{1} \\left(\\eta_{01} s_{0}^{2} + \\eta_{11} t_{0}^{2} + \\eta_{12} n_{0}^{2}\\right)\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{0} n_{1} \\left(\\eta_{02} s_{1}^{2} + \\eta_{12} t_{1}^{2} + \\eta_{22} n_{1}^{2} + \\eta_{33} t_{1}^{2} + \\eta_{44} s_{1}^{2}\\right) + 2 s_{0} s_{1} \\left(\\eta_{00} s_{1}^{2} + \\eta_{01} t_{1}^{2} + \\eta_{02} n_{1}^{2} + \\eta_{44} n_{1}^{2} + \\eta_{55} t_{1}^{2}\\right) + 2 t_{0} t_{1} \\left(\\eta_{01} s_{1}^{2} + \\eta_{11} t_{1}^{2} + \\eta_{12} n_{1}^{2} + \\eta_{33} n_{1}^{2} + \\eta_{55} s_{1}^{2}\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{0} \\left(\\eta_{33} n_{2} t_{1} t_{2} + \\eta_{44} n_{2} s_{1} s_{2} + n_{1} \\left(\\eta_{02} s_{2}^{2} + \\eta_{12} t_{2}^{2} + \\eta_{22} n_{2}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{1} n_{2} s_{2} + \\eta_{55} s_{2} t_{1} t_{2} + s_{1} \\left(\\eta_{00} s_{2}^{2} + \\eta_{01} t_{2}^{2} + \\eta_{02} n_{2}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{1} n_{2} t_{2} + \\eta_{55} s_{1} s_{2} t_{2} + t_{1} \\left(\\eta_{01} s_{2}^{2} + \\eta_{11} t_{2}^{2} + \\eta_{12} n_{2}^{2}\\right)\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{1} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{1} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{1} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{1} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{1} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{1} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{1} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{1} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{1} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{1} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{1} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{1} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{1} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{1} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{1} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{1} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{1} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{1} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{1} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{1} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{1} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{1} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{1} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{1} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{1} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{1} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{1} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\end{matrix}\\right]\\]\nIn the Browaeys formulation, the orthorhombic part has two unique values (in the Voigt notation this gives three unique entries in the \\(C_{IJ}\\) matrix). The canonical (Mandel) form is\n\\[\\left[\\begin{matrix}2 \\xi_{0} & 0 & 2 \\xi_{1} & 0 & 0 & 0\\\\0 & - 2 \\xi_{0} & - 2 \\xi_{1} & 0 & 0 & 0\\\\2 \\xi_{1} & - 2 \\xi_{1} & 0 & 0 & 0 & 0\\\\0 & 0 & 0 & - 2 \\xi_{1} & 0 & 0\\\\0 & 0 & 0 & 0 & 2 \\xi_{1} & 0\\\\0 & 0 & 0 & 0 & 0 & 0\\end{matrix}\\right]\\]\nThe rotated form:\n\\[\\left[\\begin{matrix}2 \\eta_{00} s_{0}^{4} + 4 \\eta_{01} s_{0}^{2} t_{0}^{2} + 4 \\eta_{02} n_{0}^{2} s_{0}^{2} + 2 \\eta_{11} t_{0}^{4} + 4 \\eta_{12} n_{0}^{2} t_{0}^{2} + 2 \\eta_{22} n_{0}^{4} + 4 \\eta_{33} n_{0}^{2} t_{0}^{2} + 4 \\eta_{44} n_{0}^{2} s_{0}^{2} + 4 \\eta_{55} s_{0}^{2} t_{0}^{2} & 2 n_{0} \\left(\\eta_{33} n_{1} t_{0} t_{1} + \\eta_{44} n_{1} s_{0} s_{1} + n_{0} \\left(\\eta_{02} s_{1}^{2} + \\eta_{12} t_{1}^{2} + \\eta_{22} n_{1}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{0} n_{1} s_{1} + \\eta_{55} s_{1} t_{0} t_{1} + s_{0} \\left(\\eta_{00} s_{1}^{2} + \\eta_{01} t_{1}^{2} + \\eta_{02} n_{1}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{0} n_{1} t_{1} + \\eta_{55} s_{0} s_{1} t_{1} + t_{0} \\left(\\eta_{01} s_{1}^{2} + \\eta_{11} t_{1}^{2} + \\eta_{12} n_{1}^{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} n_{2} t_{0} t_{2} + \\eta_{44} n_{2} s_{0} s_{2} + n_{0} \\left(\\eta_{02} s_{2}^{2} + \\eta_{12} t_{2}^{2} + \\eta_{22} n_{2}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{0} n_{2} s_{2} + \\eta_{55} s_{2} t_{0} t_{2} + s_{0} \\left(\\eta_{00} s_{2}^{2} + \\eta_{01} t_{2}^{2} + \\eta_{02} n_{2}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{0} n_{2} t_{2} + \\eta_{55} s_{0} s_{2} t_{2} + t_{0} \\left(\\eta_{01} s_{2}^{2} + \\eta_{11} t_{2}^{2} + \\eta_{12} n_{2}^{2}\\right)\\right) & \\sqrt{2} \\left(n_{0} \\left(\\eta_{33} t_{0} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{0} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{0} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + s_{0} \\left(\\eta_{44} n_{0} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{0} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{0} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + t_{0} \\left(\\eta_{33} n_{0} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{0} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{0} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{0} \\left(\\eta_{33} t_{0} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{0} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{0} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + s_{0} \\left(\\eta_{44} n_{0} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{0} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{0} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + t_{0} \\left(\\eta_{33} n_{0} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{0} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{0} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{0} \\left(\\eta_{33} t_{0} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{0} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{0} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + s_{0} \\left(\\eta_{44} n_{0} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{0} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{0} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + t_{0} \\left(\\eta_{33} n_{0} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{0} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{0} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\right)\\\\2 n_{1} \\left(\\eta_{33} n_{0} t_{0} t_{1} + \\eta_{44} n_{0} s_{0} s_{1} + n_{1} \\left(\\eta_{02} s_{0}^{2} + \\eta_{12} t_{0}^{2} + \\eta_{22} n_{0}^{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{0} n_{1} s_{0} + \\eta_{55} s_{0} t_{0} t_{1} + s_{1} \\left(\\eta_{00} s_{0}^{2} + \\eta_{01} t_{0}^{2} + \\eta_{02} n_{0}^{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{0} n_{1} t_{0} + \\eta_{55} s_{0} s_{1} t_{0} + t_{1} \\left(\\eta_{01} s_{0}^{2} + \\eta_{11} t_{0}^{2} + \\eta_{12} n_{0}^{2}\\right)\\right) & 2 \\eta_{00} s_{1}^{4} + 4 \\eta_{01} s_{1}^{2} t_{1}^{2} + 4 \\eta_{02} n_{1}^{2} s_{1}^{2} + 2 \\eta_{11} t_{1}^{4} + 4 \\eta_{12} n_{1}^{2} t_{1}^{2} + 2 \\eta_{22} n_{1}^{4} + 4 \\eta_{33} n_{1}^{2} t_{1}^{2} + 4 \\eta_{44} n_{1}^{2} s_{1}^{2} + 4 \\eta_{55} s_{1}^{2} t_{1}^{2} & 2 n_{1} \\left(\\eta_{33} n_{2} t_{1} t_{2} + \\eta_{44} n_{2} s_{1} s_{2} + n_{1} \\left(\\eta_{02} s_{2}^{2} + \\eta_{12} t_{2}^{2} + \\eta_{22} n_{2}^{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{1} n_{2} s_{2} + \\eta_{55} s_{2} t_{1} t_{2} + s_{1} \\left(\\eta_{00} s_{2}^{2} + \\eta_{01} t_{2}^{2} + \\eta_{02} n_{2}^{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{1} n_{2} t_{2} + \\eta_{55} s_{1} s_{2} t_{2} + t_{1} \\left(\\eta_{01} s_{2}^{2} + \\eta_{11} t_{2}^{2} + \\eta_{12} n_{2}^{2}\\right)\\right) & \\sqrt{2} \\left(n_{1} \\left(\\eta_{33} t_{1} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{1} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{1} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + s_{1} \\left(\\eta_{44} n_{1} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{1} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{1} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + t_{1} \\left(\\eta_{33} n_{1} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{1} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{1} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{1} \\left(\\eta_{33} t_{1} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{1} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{1} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + s_{1} \\left(\\eta_{44} n_{1} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{1} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{1} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + t_{1} \\left(\\eta_{33} n_{1} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{1} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{1} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{1} \\left(\\eta_{33} t_{1} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{1} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{1} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + s_{1} \\left(\\eta_{44} n_{1} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{1} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{1} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + t_{1} \\left(\\eta_{33} n_{1} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{1} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{1} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\right)\\\\2 n_{2} \\left(\\eta_{33} n_{0} t_{0} t_{2} + \\eta_{44} n_{0} s_{0} s_{2} + n_{2} \\left(\\eta_{02} s_{0}^{2} + \\eta_{12} t_{0}^{2} + \\eta_{22} n_{0}^{2}\\right)\\right) + 2 s_{2} \\left(\\eta_{44} n_{0} n_{2} s_{0} + \\eta_{55} s_{0} t_{0} t_{2} + s_{2} \\left(\\eta_{00} s_{0}^{2} + \\eta_{01} t_{0}^{2} + \\eta_{02} n_{0}^{2}\\right)\\right) + 2 t_{2} \\left(\\eta_{33} n_{0} n_{2} t_{0} + \\eta_{55} s_{0} s_{2} t_{0} + t_{2} \\left(\\eta_{01} s_{0}^{2} + \\eta_{11} t_{0}^{2} + \\eta_{12} n_{0}^{2}\\right)\\right) & 2 n_{2} \\left(\\eta_{33} n_{1} t_{1} t_{2} + \\eta_{44} n_{1} s_{1} s_{2} + n_{2} \\left(\\eta_{02} s_{1}^{2} + \\eta_{12} t_{1}^{2} + \\eta_{22} n_{1}^{2}\\right)\\right) + 2 s_{2} \\left(\\eta_{44} n_{1} n_{2} s_{1} + \\eta_{55} s_{1} t_{1} t_{2} + s_{2} \\left(\\eta_{00} s_{1}^{2} + \\eta_{01} t_{1}^{2} + \\eta_{02} n_{1}^{2}\\right)\\right) + 2 t_{2} \\left(\\eta_{33} n_{1} n_{2} t_{1} + \\eta_{55} s_{1} s_{2} t_{1} + t_{2} \\left(\\eta_{01} s_{1}^{2} + \\eta_{11} t_{1}^{2} + \\eta_{12} n_{1}^{2}\\right)\\right) & 2 \\eta_{00} s_{2}^{4} + 4 \\eta_{01} s_{2}^{2} t_{2}^{2} + 4 \\eta_{02} n_{2}^{2} s_{2}^{2} + 2 \\eta_{11} t_{2}^{4} + 4 \\eta_{12} n_{2}^{2} t_{2}^{2} + 2 \\eta_{22} n_{2}^{4} + 4 \\eta_{33} n_{2}^{2} t_{2}^{2} + 4 \\eta_{44} n_{2}^{2} s_{2}^{2} + 4 \\eta_{55} s_{2}^{2} t_{2}^{2} & \\sqrt{2} \\left(n_{2} \\left(\\eta_{33} t_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{2} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + s_{2} \\left(\\eta_{44} n_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{2} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + t_{2} \\left(\\eta_{33} n_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{2} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{2} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + s_{2} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + t_{2} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right)\\right) & \\sqrt{2} \\left(n_{2} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + s_{2} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + t_{2} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\right)\\\\\\sqrt{2} \\cdot \\left(2 n_{1} \\left(\\eta_{33} n_{0} t_{0} t_{2} + \\eta_{44} n_{0} s_{0} s_{2} + n_{2} \\left(\\eta_{02} s_{0}^{2} + \\eta_{12} t_{0}^{2} + \\eta_{22} n_{0}^{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{0} n_{2} s_{0} + \\eta_{55} s_{0} t_{0} t_{2} + s_{2} \\left(\\eta_{00} s_{0}^{2} + \\eta_{01} t_{0}^{2} + \\eta_{02} n_{0}^{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{0} n_{2} t_{0} + \\eta_{55} s_{0} s_{2} t_{0} + t_{2} \\left(\\eta_{01} s_{0}^{2} + \\eta_{11} t_{0}^{2} + \\eta_{12} n_{0}^{2}\\right)\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{1} \\left(\\eta_{33} n_{1} t_{1} t_{2} + \\eta_{44} n_{1} s_{1} s_{2} + n_{2} \\left(\\eta_{02} s_{1}^{2} + \\eta_{12} t_{1}^{2} + \\eta_{22} n_{1}^{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{1} n_{2} s_{1} + \\eta_{55} s_{1} t_{1} t_{2} + s_{2} \\left(\\eta_{00} s_{1}^{2} + \\eta_{01} t_{1}^{2} + \\eta_{02} n_{1}^{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{1} n_{2} t_{1} + \\eta_{55} s_{1} s_{2} t_{1} + t_{2} \\left(\\eta_{01} s_{1}^{2} + \\eta_{11} t_{1}^{2} + \\eta_{12} n_{1}^{2}\\right)\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{1} n_{2} \\left(\\eta_{02} s_{2}^{2} + \\eta_{12} t_{2}^{2} + \\eta_{22} n_{2}^{2} + \\eta_{33} t_{2}^{2} + \\eta_{44} s_{2}^{2}\\right) + 2 s_{1} s_{2} \\left(\\eta_{00} s_{2}^{2} + \\eta_{01} t_{2}^{2} + \\eta_{02} n_{2}^{2} + \\eta_{44} n_{2}^{2} + \\eta_{55} t_{2}^{2}\\right) + 2 t_{1} t_{2} \\left(\\eta_{01} s_{2}^{2} + \\eta_{11} t_{2}^{2} + \\eta_{12} n_{2}^{2} + \\eta_{33} n_{2}^{2} + \\eta_{55} s_{2}^{2}\\right)\\right) & 2 n_{1} \\left(\\eta_{33} t_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{2} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{2} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{2} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right) & 2 n_{1} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right) & 2 n_{1} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + 2 s_{1} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + 2 t_{1} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\\\\\sqrt{2} \\cdot \\left(2 n_{0} \\left(\\eta_{33} n_{0} t_{0} t_{2} + \\eta_{44} n_{0} s_{0} s_{2} + n_{2} \\left(\\eta_{02} s_{0}^{2} + \\eta_{12} t_{0}^{2} + \\eta_{22} n_{0}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{0} n_{2} s_{0} + \\eta_{55} s_{0} t_{0} t_{2} + s_{2} \\left(\\eta_{00} s_{0}^{2} + \\eta_{01} t_{0}^{2} + \\eta_{02} n_{0}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{0} n_{2} t_{0} + \\eta_{55} s_{0} s_{2} t_{0} + t_{2} \\left(\\eta_{01} s_{0}^{2} + \\eta_{11} t_{0}^{2} + \\eta_{12} n_{0}^{2}\\right)\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{0} \\left(\\eta_{33} n_{1} t_{1} t_{2} + \\eta_{44} n_{1} s_{1} s_{2} + n_{2} \\left(\\eta_{02} s_{1}^{2} + \\eta_{12} t_{1}^{2} + \\eta_{22} n_{1}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{1} n_{2} s_{1} + \\eta_{55} s_{1} t_{1} t_{2} + s_{2} \\left(\\eta_{00} s_{1}^{2} + \\eta_{01} t_{1}^{2} + \\eta_{02} n_{1}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{1} n_{2} t_{1} + \\eta_{55} s_{1} s_{2} t_{1} + t_{2} \\left(\\eta_{01} s_{1}^{2} + \\eta_{11} t_{1}^{2} + \\eta_{12} n_{1}^{2}\\right)\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{0} n_{2} \\left(\\eta_{02} s_{2}^{2} + \\eta_{12} t_{2}^{2} + \\eta_{22} n_{2}^{2} + \\eta_{33} t_{2}^{2} + \\eta_{44} s_{2}^{2}\\right) + 2 s_{0} s_{2} \\left(\\eta_{00} s_{2}^{2} + \\eta_{01} t_{2}^{2} + \\eta_{02} n_{2}^{2} + \\eta_{44} n_{2}^{2} + \\eta_{55} t_{2}^{2}\\right) + 2 t_{0} t_{2} \\left(\\eta_{01} s_{2}^{2} + \\eta_{11} t_{2}^{2} + \\eta_{12} n_{2}^{2} + \\eta_{33} n_{2}^{2} + \\eta_{55} s_{2}^{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{2} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{2} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{2} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{2} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{2} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{2} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{2} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{2} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{2} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{2} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{2} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{2} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\\\\\sqrt{2} \\cdot \\left(2 n_{0} \\left(\\eta_{33} n_{0} t_{0} t_{1} + \\eta_{44} n_{0} s_{0} s_{1} + n_{1} \\left(\\eta_{02} s_{0}^{2} + \\eta_{12} t_{0}^{2} + \\eta_{22} n_{0}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{0} n_{1} s_{0} + \\eta_{55} s_{0} t_{0} t_{1} + s_{1} \\left(\\eta_{00} s_{0}^{2} + \\eta_{01} t_{0}^{2} + \\eta_{02} n_{0}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{0} n_{1} t_{0} + \\eta_{55} s_{0} s_{1} t_{0} + t_{1} \\left(\\eta_{01} s_{0}^{2} + \\eta_{11} t_{0}^{2} + \\eta_{12} n_{0}^{2}\\right)\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{0} n_{1} \\left(\\eta_{02} s_{1}^{2} + \\eta_{12} t_{1}^{2} + \\eta_{22} n_{1}^{2} + \\eta_{33} t_{1}^{2} + \\eta_{44} s_{1}^{2}\\right) + 2 s_{0} s_{1} \\left(\\eta_{00} s_{1}^{2} + \\eta_{01} t_{1}^{2} + \\eta_{02} n_{1}^{2} + \\eta_{44} n_{1}^{2} + \\eta_{55} t_{1}^{2}\\right) + 2 t_{0} t_{1} \\left(\\eta_{01} s_{1}^{2} + \\eta_{11} t_{1}^{2} + \\eta_{12} n_{1}^{2} + \\eta_{33} n_{1}^{2} + \\eta_{55} s_{1}^{2}\\right)\\right) & \\sqrt{2} \\cdot \\left(2 n_{0} \\left(\\eta_{33} n_{2} t_{1} t_{2} + \\eta_{44} n_{2} s_{1} s_{2} + n_{1} \\left(\\eta_{02} s_{2}^{2} + \\eta_{12} t_{2}^{2} + \\eta_{22} n_{2}^{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{1} n_{2} s_{2} + \\eta_{55} s_{2} t_{1} t_{2} + s_{1} \\left(\\eta_{00} s_{2}^{2} + \\eta_{01} t_{2}^{2} + \\eta_{02} n_{2}^{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{1} n_{2} t_{2} + \\eta_{55} s_{1} s_{2} t_{2} + t_{1} \\left(\\eta_{01} s_{2}^{2} + \\eta_{11} t_{2}^{2} + \\eta_{12} n_{2}^{2}\\right)\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{1} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{44} s_{1} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + 2 n_{1} \\left(\\eta_{02} s_{1} s_{2} + \\eta_{12} t_{1} t_{2} + \\eta_{22} n_{1} n_{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{1} \\left(n_{1} s_{2} + n_{2} s_{1}\\right) + \\eta_{55} t_{1} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 s_{1} \\left(\\eta_{00} s_{1} s_{2} + \\eta_{01} t_{1} t_{2} + \\eta_{02} n_{1} n_{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{1} \\left(n_{1} t_{2} + n_{2} t_{1}\\right) + \\eta_{55} s_{1} \\left(s_{1} t_{2} + s_{2} t_{1}\\right) + 2 t_{1} \\left(\\eta_{01} s_{1} s_{2} + \\eta_{11} t_{1} t_{2} + \\eta_{12} n_{1} n_{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{1} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{44} s_{1} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + 2 n_{1} \\left(\\eta_{02} s_{0} s_{2} + \\eta_{12} t_{0} t_{2} + \\eta_{22} n_{0} n_{2}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{1} \\left(n_{0} s_{2} + n_{2} s_{0}\\right) + \\eta_{55} t_{1} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 s_{1} \\left(\\eta_{00} s_{0} s_{2} + \\eta_{01} t_{0} t_{2} + \\eta_{02} n_{0} n_{2}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{1} \\left(n_{0} t_{2} + n_{2} t_{0}\\right) + \\eta_{55} s_{1} \\left(s_{0} t_{2} + s_{2} t_{0}\\right) + 2 t_{1} \\left(\\eta_{01} s_{0} s_{2} + \\eta_{11} t_{0} t_{2} + \\eta_{12} n_{0} n_{2}\\right)\\right) & 2 n_{0} \\left(\\eta_{33} t_{1} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{44} s_{1} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + 2 n_{1} \\left(\\eta_{02} s_{0} s_{1} + \\eta_{12} t_{0} t_{1} + \\eta_{22} n_{0} n_{1}\\right)\\right) + 2 s_{0} \\left(\\eta_{44} n_{1} \\left(n_{0} s_{1} + n_{1} s_{0}\\right) + \\eta_{55} t_{1} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 s_{1} \\left(\\eta_{00} s_{0} s_{1} + \\eta_{01} t_{0} t_{1} + \\eta_{02} n_{0} n_{1}\\right)\\right) + 2 t_{0} \\left(\\eta_{33} n_{1} \\left(n_{0} t_{1} + n_{1} t_{0}\\right) + \\eta_{55} s_{1} \\left(s_{0} t_{1} + s_{1} t_{0}\\right) + 2 t_{1} \\left(\\eta_{01} s_{0} s_{1} + \\eta_{11} t_{0} t_{1} + \\eta_{12} n_{0} n_{1}\\right)\\right)\\end{matrix}\\right]\n\\]\nThe python code for this is:\n\n\n\n\n\n\nUnderworld python script\n\n\n\n\n\n## I can't see much benefit in expanding the full orthorhombic model\n## in this way - keeping the rotations separated makes more sense.\n\neta_00 = sympy.symbols(r\"\\eta_00\")\neta_11 = sympy.symbols(r\"\\eta_11\")\neta_22 = sympy.symbols(r\"\\eta_22\")\neta_33 = sympy.symbols(r\"\\eta_33\")\neta_44 = sympy.symbols(r\"\\eta_44\")\neta_55 = sympy.symbols(r\"\\eta_55\")\neta_01 = sympy.symbols(r\"\\eta_01\")\neta_02 = sympy.symbols(r\"\\eta_02\")\neta_12 = sympy.symbols(r\"\\eta_12\")\n\nI_ijkl = uw.maths.tensor.rank4_identity(3) * 0\nC_IJm_ORTHO = uw.maths.tensor.rank4_to_mandel(I_ijkl, 3)\n\nC_IJm_ORTHO[0,0] = 2*eta_00\nC_IJm_ORTHO[1,1] = 2*eta_11\nC_IJm_ORTHO[2,2] = 2*eta_22\nC_IJm_ORTHO[3,3] = 2*eta_33  # yz\nC_IJm_ORTHO[4,4] = 2*eta_44  # xz\nC_IJm_ORTHO[5,5] = 2*eta_55  # xy\nC_IJm_ORTHO[0,1] = C_IJm_ORTHO[1,0] = 2*eta_01\nC_IJm_ORTHO[0,2] = C_IJm_ORTHO[2,0] = 2*eta_02\nC_IJm_ORTHO[1,2] = C_IJm_ORTHO[2,1] = 2*eta_12\n\nC_ijkl_ORTHO = uw.maths.tensor.mandel_to_rank4(C_IJm_ORTHO, 3)\nC_IJv_ORTHO = sympy.simplify(uw.maths.tensor.rank4_to_voigt(C_ijkl_ORTHO, 3))\n\ndisplay(C_IJv_ORTHO)\n\n# Rotation: Use 3 orthogonal unit vectors to define cannonical orientation\n\nn = sympy.Matrix(sympy.symarray(\"n\",(3,)))\ns = sympy.Matrix(sympy.symarray(\"s\",(3,)))\nt = sympy.Matrix(sympy.symarray(\"t\",(3,)))\n\n# This would work but is less clear in terms of notation\n# t = -mesh3.vector.cross(n,s).T # complete the coordinate triad\n\nRx = sympy.BlockMatrix((s,t,n)).as_explicit()\n\ndisplay(Rx)\n\nC_ijkl_ORTHO = uw.maths.tensor.mandel_to_rank4(C_IJm_ORTHO, 3)\nC_ijkl_ORTHO_R = sympy.simplify(uw.maths.tensor.tensor_rotation(Rx, C_ijkl_ORTHO))\nuw.maths.tensor.rank4_to_mandel(C_ijkl_ORTHO_R, 3)\n\n# print(sympy.latex(uw.maths.tensor.rank4_to_mandel(C_ijkl_ORTHO_R, 3)))\n\nxi_0 = sympy.symbols(r\"\\xi_0\")\nxi_1 = sympy.symbols(r\"\\xi_0\")\n\nI_ijkl = uw.maths.tensor.rank4_identity(3) * 0\nC_IJm_BC = uw.maths.tensor.rank4_to_mandel(I_ijkl, 3)\n\nC_IJm_BC[0,0] =  2*xi_0\nC_IJm_BC[1,1] = -2*xi_0\nC_IJm_BC[3,3] = -2*xi_1  # yz\nC_IJm_BC[4,4] = 2*xi_1  # xz\nC_IJm_BC[5,5] = 0\nC_IJm_BC[0,2] = C_IJm_BC[2,0] = 2*xi_1\nC_IJm_BC[1,2] = C_IJm_BC[2,1] = -2*xi_1\n\nC_ijkl_BC = uw.maths.tensor.mandel_to_rank4(C_IJm_BC, 3)\nC_IJv_BC = sympy.simplify(uw.maths.tensor.rank4_to_voigt(C_ijkl_BC, 3))\n\n# print(sympy.latex(C_IJm_BC))\n\nC_IJv_BC\n\n# Rotation by Rx\n\nC_ijkl_BC = uw.maths.tensor.mandel_to_rank4(C_IJm_BC, 3)\nC_ijkl_BC_R = sympy.simplify(uw.maths.tensor.tensor_rotation(Rx, C_ijkl_ORTHO))\nuw.maths.tensor.rank4_to_mandel(C_ijkl_BC_R, 3)\n\n# print(sympy.latex(uw.maths.tensor.rank4_to_mandel(C_ijkl_BC_R, 3)))\n\n\n\n\n\n\n\nNye, J. F. 1984. Physical Properties of Crystals: Their Representation by Tensors and Matrices. 1st published in pbk. with corrections, 1984. Oxford [Oxfordshire] : New York: Clarendon Press ; Oxford University Press.",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#incompressible-materials",
    "href": "ConstitutiveModels_Anisotropy.html#incompressible-materials",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "4.2 Incompressible materials",
    "text": "4.2 Incompressible materials\nIf we apply constraints to the deformation, we expect to reduce the number of independent material constants. Incompressibility should reduce the number of independent material constants. In an isotropic medium (or a medium with cubic symmetry), incompressibility eliminates the one volumetric material modulus (e.g. the bulk modulus). In general anisotropic media, it is not the case that changes in pressure result in uniform expansion or contraction, and an incompressibility constraint reduces the number of independent material constants. In the transversely isotropic case, there are five independent materia constants in general, reducing to four when the material is incompressible.\nIt is not a given that the stiffness matrix is trivial to construct / meaningful for incompressible anisotropy and there is some discussion here: https://rastgaragah.wordpress.com/2013/03/12/incompressibility-of-linearly-elastic-material/ (identifies the issue) and this is explained in more detail by {cite}destradeIncompressibleLimitLinear2002\n\n4.2.1 Example\nFirst we define the rotation for the transversely isotropic case which depends on the normal vector to the symmetry plane.\nA rotation matrix for a transversely isotropic medium is defined by specifying the normal of the symmetry plane ($ = { n_0, n_1, n_2} $). The other orientations are arbitrary, so we simply derive them from \\(\\hat{\\mathbf{n}}\\) - one vector specified to be perpendicular in the horizontal plane and the third vector is then found from their cross product (\\(\\hat{\\mathbf{s}}\\) and \\(\\hat{\\mathbf{t}}\\) respectively)\n\n\n\n\n\n\nUnderworld python script\n\n\n\n\n\nimport underworld3 as uw\nimport sympy\n\nn = sympy.Matrix(sympy.symarray(\"n\",(3,)))\n\n# Or give a specific value (just specify a vector, then normalise)\n# n = sympy.Matrix([1,1,1]) \n# n /= sympy.sqrt(n.dot(n))\n\nif n[0] == 0:\n    s = sympy.Matrix([1,0,0])\n    t = sympy.Matrix([0,1,0])\n    R = sympy.eye(3)\n\nelse:\n    s = sympy.Matrix((n[1] , -n[0], 0 ))\n    s /= sympy.sqrt(s.dot(s))\n    t = -n.cross(s) # complete the coordinate triad\n    R = sympy.BlockMatrix((s,t,n)).as_explicit()\n\ndisplay(R)\n\n\n\n\\[\\cal{R} = \\left[\\begin{matrix}\\frac{n_{1}}{\\sqrt{n_{0}^{2} + n_{1}^{2}}} & - \\frac{n_{0} n_{2}}{\\sqrt{n_{0}^{2} + n_{1}^{2}}} & n_{0}\\\\- \\frac{n_{0}}{\\sqrt{n_{0}^{2} + n_{1}^{2}}} & - \\frac{n_{1} n_{2}}{\\sqrt{n_{0}^{2} + n_{1}^{2}}} & n_{1}\\\\0 & \\frac{n_{0}^{2}}{\\sqrt{n_{0}^{2} + n_{1}^{2}}} + \\frac{n_{1}^{2}}{\\sqrt{n_{0}^{2} + n_{1}^{2}}} & n_{2}\\end{matrix}\\right]\\]",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#validation",
    "href": "ConstitutiveModels_Anisotropy.html#validation",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "4.3 Validation",
    "text": "4.3 Validation\nA simple check on this is to rotate the isotropic constitutive tensor and validate that it is invariant under rotation.\n\\[C_{IJ} = \\left[\\begin{matrix}2 \\eta_{0} & 0 & 0 & 0 & 0 & 0\\\\0 & 2 \\eta_{0} & 0 & 0 & 0 & 0\\\\0 & 0 & 2 \\eta_{0} & 0 & 0 & 0\\\\0 & 0 & 0 & 2 \\eta_{0} & 0 & 0\\\\0 & 0 & 0 & 0 & 2 \\eta_{0} & 0\\\\0 & 0 & 0 & 0 & 0 & 2 \\eta_{0}\\end{matrix}\\right]\\]\nNoting that the rotation of the Mandel or Voigt constitutive matrices is complicated by the \\(\\mathbf{P}\\) scaling matrices, we compute rotations on the rank 4 tensor, \\(c_{ijkl}\\) and transform to the matrix forms as required. We denote the rotation from \\(\\{IJ\\}\\) coordinates to \\(\\{I'J'\\}\\) as\n\\[C_{I'J'} = {\\cal R}[C_{IJ}]\\]\nThe rotated constitutive model has the following form:\n\\[C_{I'J'} = \\left[\\begin{matrix}\\frac{2 \\eta_{0} \\left(n_{0}^{2} n_{2}^{2} + n_{0}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right) + n_{1}^{2}\\right)^{2}}{\\left(n_{0}^{2} + n_{1}^{2}\\right)^{2}} & \\frac{2 \\eta_{0} n_{0}^{2} n_{1}^{2} \\left(n_{0}^{2} + n_{1}^{2} + n_{2}^{2} - 1\\right)^{2}}{\\left(n_{0}^{2} + n_{1}^{2}\\right)^{2}} & 0 & 0 & 0 & \\frac{2 \\sqrt{2} \\eta_{0} n_{0} n_{1} \\left(n_{0}^{6} + 2 n_{0}^{4} n_{1}^{2} + 2 n_{0}^{4} n_{2}^{2} - n_{0}^{4} + n_{0}^{2} n_{1}^{4} + 2 n_{0}^{2} n_{1}^{2} n_{2}^{2} + n_{0}^{2} n_{2}^{4} - n_{0}^{2} n_{2}^{2} + n_{1}^{4} + n_{1}^{2} n_{2}^{2} - n_{1}^{2}\\right)}{n_{0}^{4} + 2 n_{0}^{2} n_{1}^{2} + n_{1}^{4}}\\\\\\frac{2 \\eta_{0} n_{0}^{2} n_{1}^{2} \\left(n_{0}^{2} + n_{1}^{2} + n_{2}^{2} - 1\\right)^{2}}{\\left(n_{0}^{2} + n_{1}^{2}\\right)^{2}} & \\frac{2 \\eta_{0} \\left(n_{0}^{2} + n_{1}^{2} n_{2}^{2} + n_{1}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right)\\right)^{2}}{\\left(n_{0}^{2} + n_{1}^{2}\\right)^{2}} & 0 & 0 & 0 & \\frac{2 \\sqrt{2} \\eta_{0} n_{0} n_{1} \\left(n_{0}^{4} n_{1}^{2} + n_{0}^{4} + 2 n_{0}^{2} n_{1}^{4} + 2 n_{0}^{2} n_{1}^{2} n_{2}^{2} + n_{0}^{2} n_{2}^{2} - n_{0}^{2} + n_{1}^{6} + 2 n_{1}^{4} n_{2}^{2} - n_{1}^{4} + n_{1}^{2} n_{2}^{4} - n_{1}^{2} n_{2}^{2}\\right)}{n_{0}^{4} + 2 n_{0}^{2} n_{1}^{2} + n_{1}^{4}}\\\\0 & 0 & 2 \\eta_{0} \\left(n_{0}^{2} + n_{1}^{2} + n_{2}^{2}\\right)^{2} & 0 & 0 & 0\\\\0 & 0 & 0 & \\frac{2 \\eta_{0} \\left(n_{0}^{2} + n_{1}^{2} + n_{2}^{2}\\right) \\left(n_{0}^{2} + n_{1}^{2} n_{2}^{2} + n_{1}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right)\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\eta_{0} n_{0} n_{1} \\left(n_{0}^{2} + n_{1}^{2} + n_{2}^{2}\\right) \\left(n_{0}^{2} + n_{1}^{2} + n_{2}^{2} - 1\\right)}{n_{0}^{2} + n_{1}^{2}} & 0\\\\0 & 0 & 0 & \\frac{2 \\eta_{0} n_{0} n_{1} \\left(n_{0}^{2} + n_{1}^{2} + n_{2}^{2}\\right) \\left(n_{0}^{2} + n_{1}^{2} + n_{2}^{2} - 1\\right)}{n_{0}^{2} + n_{1}^{2}} & \\frac{2 \\eta_{0} \\left(n_{0}^{2} + n_{1}^{2} + n_{2}^{2}\\right) \\left(n_{0}^{2} n_{2}^{2} + n_{0}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right) + n_{1}^{2}\\right)}{n_{0}^{2} + n_{1}^{2}} & 0\\\\\\frac{2 \\sqrt{2} \\eta_{0} n_{0} n_{1} \\left(n_{0}^{2} n_{2}^{2} + n_{0}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right) + n_{1}^{2}\\right) \\left(n_{0}^{2} + n_{1}^{2} + n_{2}^{2} - 1\\right)}{\\left(n_{0}^{2} + n_{1}^{2}\\right)^{2}} & \\frac{2 \\sqrt{2} \\eta_{0} n_{0} n_{1} \\left(n_{0}^{2} + n_{1}^{2} n_{2}^{2} + n_{1}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right)\\right) \\left(n_{0}^{2} + n_{1}^{2} + n_{2}^{2} - 1\\right)}{\\left(n_{0}^{2} + n_{1}^{2}\\right)^{2}} & 0 & 0 & 0 & \\frac{2 \\eta_{0} \\left(n_{0}^{2} n_{2}^{2} \\left(n_{0}^{2} + 2 n_{1}^{2} n_{2}^{2} + 2 n_{1}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right) - n_{1}^{2}\\right) + n_{0}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right) \\left(n_{0}^{2} + 2 n_{1}^{2} n_{2}^{2} + 2 n_{1}^{2} \\left(n_{0}^{2} + n_{1}^{2}\\right) - n_{1}^{2}\\right) + n_{1}^{2} \\cdot \\left(2 n_{0}^{2} + n_{2}^{2} \\left(- n_{0}^{2} + n_{1}^{2}\\right) - \\left(n_{0}^{2} - n_{1}^{2}\\right) \\left(n_{0}^{2} + n_{1}^{2}\\right)\\right)\\right)}{\\left(n_{0}^{2} + n_{1}^{2}\\right)^{2}}\\end{matrix}\\right]\\]\nHowever, \\(\\{n_0, n_1, n_2\\}\\) are not independent because \\(\\hat{\\mathbf{n}}\\) is a unit vector. If we add this information and simplify, we recover the isotropic form of \\(C\\)\n\n\n\n\n\n\nUnderworld python script\n\n\n\n\n\n\n# construct a symbolic, isotropic matrix (Mandel form)\n\neta0 = sympy.symbols(\"\\eta_0\")\nC_IJm = 2 * sympy.Matrix.diag([eta0]*6)\ndisplay(C_IJm)\n\n## Rotate the matrix \n\nc_ijkl = uw.maths.tensor.mandel_to_rank4(C_IJm, 3)\nC_IJv = uw.maths.tensor.rank4_to_voigt(c_ijkl, 3)\nc_ijkl_R = sympy.simplify(uw.maths.tensor.tensor_rotation(R, c_ijkl))\nC_IJm_R = sympy.simplify(uw.maths.tensor.rank4_to_mandel(c_ijkl_R, 3))\ndisplay(C_IJm_R)\n\n## Is this really invariant under rotation ?? \n## Have to do some manipulation to identify the \n## unit-vector component relationships\n\nC_IJm_R_s1 = C_IJm_R.subs(n[0]**2+n[1]**2+n[2]**2,1)\nC_IJm_R_s2 = C_IJm_R_s1.subs(n[0]**2+n[1]**2, 1-n[2]**2).applyfunc(sympy.factor)\n\ndisplay(C_IJm_R_s2.subs(n[0]**2+n[1]**2, 1-n[2]**2).simplify())",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#rotate-the-matrix",
    "href": "ConstitutiveModels_Anisotropy.html#rotate-the-matrix",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "4.4 Rotate the matrix",
    "text": "4.4 Rotate the matrix\nc_ijkl = uw.maths.tensor.mandel_to_rank4(C_IJm, 3) C_IJv = uw.maths.tensor.rank4_to_voigt(c_ijkl, 3) c_ijkl_R = sympy.simplify(uw.maths.tensor.tensor_rotation(R, c_ijkl)) C_IJm_R = sympy.simplify(uw.maths.tensor.rank4_to_mandel(c_ijkl_R, 3)) display(C_IJm_R)",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#is-this-really-invariant-under-rotation",
    "href": "ConstitutiveModels_Anisotropy.html#is-this-really-invariant-under-rotation",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "4.5 Is this really invariant under rotation ??",
    "text": "4.5 Is this really invariant under rotation ??",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#have-to-do-some-manipulation-to-identify-the",
    "href": "ConstitutiveModels_Anisotropy.html#have-to-do-some-manipulation-to-identify-the",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "4.6 Have to do some manipulation to identify the",
    "text": "4.6 Have to do some manipulation to identify the",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "ConstitutiveModels_Anisotropy.html#unit-vector-component-relationships",
    "href": "ConstitutiveModels_Anisotropy.html#unit-vector-component-relationships",
    "title": "4  Underworld 3: Anisotropic Constitutive Models",
    "section": "4.7 unit-vector component relationships",
    "text": "4.7 unit-vector component relationships\nC_IJm_R_s1 = C_IJm_R.subs(n[0]2+n[1]2+n[2]2,1) C_IJm_R_s2 = C_IJm_R_s1.subs(n[0]2+n[1]2, 1-n[2]2).applyfunc(sympy.factor)\ndisplay(C_IJm_R_s2.subs(n[0]2+n[1]2, 1-n[2]**2).simplify())",
    "crumbs": [
      "Constitutive Models",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Underworld 3: Anisotropic Constitutive Models</span>"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Underworld3 Documentation",
    "section": "",
    "text": "LANDING Page\nNot much content in the intro at this point\nUpdate the _quarto.yml first, then fix the rest",
    "crumbs": [
      "Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Underworld 3</span>"
    ]
  },
  {
    "objectID": "Visualisation.html",
    "href": "Visualisation.html",
    "title": "5  Underworld 3: Visualisation",
    "section": "",
    "text": "from underworld3 import visualisation",
    "crumbs": [
      "Analysis of Results",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Underworld 3: Visualisation</span>"
    ]
  }
]